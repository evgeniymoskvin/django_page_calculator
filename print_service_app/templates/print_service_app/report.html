{% extends "print_service_app/base.html" %}
{% load static %}
{% block title %}
    Сформировать отчет
{% endblock %}

{% block content %}
    <div class="d-flex w-100 flex-column">
        <div class="d-flex text-36px-bold mt-5">
            Сформировать отчет
        </div>
        <div class="d-flex text-16px-light mt-3">
            Выберите даты для формирования отчета
        </div>
        <form method="POST" name="make_report_form" id="make_report_form" data-ajax-url="{% url 'report' %}">
            {% csrf_token %}
            <div class="d-flex flex-column w-100">
                <div class="d-flex mt-3 w-25 flex-column">
                    <div class="d-flex text-16px-light"><span>Дата начала</span></div>
                    <input type="date" name="date_start" class="form-control">
                </div>
                <div class="d-flex mt-3 w-25 flex-column">
                    <div class="d-flex text-16px-light"><span>Дата окончания</span></div>
                    <input type="date" name="date_end" class="form-control">
                </div>
            </div>
            <button type="submit" class="button_blue mt-3" style="width: 200px; height: 40px">Сформировать</button>
        </form>

        <div class="d-flex text-18px-bold">
            Результат
        </div>
        <div class="d-flex">
            сюда будем подставлять
        </div>
    </div>

    <!-- Модальное окно информации о заявка-->
    <div class="modal fade" id="detailModalWindow" data-ajax-url="{% url 'get-info-task-print' %}" tabindex="-1">
    </div>

    <script>
        $('#make_report_form').submit(function (e) {
            e.preventDefault()
            {
                var url = {% url 'report' %}
                var data = new FormData($('#make_report_form').get(0))


                $.ajax({
                    type: "POST",
                    url: url,
                    data: data,
                    cache: false,
                    processData: false,
                    contentType: false,
                    success: function (data) {
                        {#console.log('done')#}
                        {#$('#sendFileModal').modal('hide');#}
                        {#$('#good_send_modal').modal('show');#}
                        console.log('done')
                    },
                    error: function () {
                        $('#sendFileModal').modal('hide');
                        $('#bad_send_modal').modal('show');
                    }
                })
            }
        })
    </script>

{% endblock %}


/*href_site = window.location.href
href_ws = href_site + 'ws/some_url/'
console.log(href_ws)
var socket = new WebSocket('ws://localhost:8003/ws/some_url/')
socket.onmessage = function (event){
var data = JSON.parse(event.data)
console.log(data)
document.getElementById('display_div').innerText = data.message
document.getElementById('display_div2').innerText = data.orm_result.data
}
*/

